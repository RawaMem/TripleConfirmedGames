extends layout

//- include utils.pug

block content
    if locals.authenticated
        div(class='flex-outer')
            div(class='art-container')
                img(src=`${games.url}`, alt="video game image", class='boxart')
            div(class='flex-inner')
                div(class='inner')
                    div(class='game-title pink')= games.title
                    div(class='game-studio bold')= games.studio
                    div(class='game-date bold')= games.releaseDate
                    div(class='game-avgRating')= games.avgCleanRating
        div(class='game-description')= games.description

        if user
            div #{user.firstName}
        div
            form(action=`/games/${games.id}/rating`, method="post")
                //- input(type="hidden", name="_csrf" value=importedToken)
                label(for="soap", class='rating-text pink bold') How Clean is this Game?
                div
                    select(name="soap", class='dropbox')
                        option(value=1) ðŸ§¼
                        option(value=2) ðŸ§¼ðŸ§¼
                        option(value=3) ðŸ§¼ðŸ§¼ðŸ§¼
                        option(value=4) ðŸ§¼ðŸ§¼ðŸ§¼ðŸ§¼
                        option(value=5) ðŸ§¼ðŸ§¼ðŸ§¼ðŸ§¼ðŸ§¼
                    button(type="submit" class='raw-btn') Clean!
        div
            if slapOn
                p(class='err-text') This game is already on this shelf
            form(action=`/users/${userId}/addGame/${gameId}`, method="post")
                p(class='shelf-text' class='pink bold') Add or Remove this game from your shelves
                //- input(type="hidden", name="_csrf" value=importedToken)
                select(name="shelfId")
                    each shelf in shelves
                        option(value=shelf.id)= shelf.name
                button(type='submit', class='raw-btn') Add/Remove
        div.anything
            +validationErrorSummary(errors)
            form(action=`/games/${games.id}`, method="post")
                input(type="hidden" name="_csrf" value=token)
                textarea(name="content" placeholder='What did you think of this game? Was it clean?')
                button(type="submit", class='raw-btn') Add A Review
        ul
            each review in games.Reviews
                li(class='username') #{review.User.username}
                li(class='content') #{review.content}
                li(id=`list${review.id}`, class='likes') Likes: #{review.ReviewLikes.length}
                //- div(id=review.id class='reviewId')

                //- div(id=userId class='myGamesUserId')
                //- input(type="hidden" id='myGamesUserId' value=userId)
                //- div(id=shelfName class='myGamesGameId')
                if user
                    div(id=userId class='userId')
                    div(id=gameId class='gameId')
                    //- form(action=`/reviews/${review.id}`, method="post")
                    button( class=`likes` id=review.id class='raw-btn') Like!
                    if user.id === review.userId
                        a(href=`/reviews/${review.id}/edit`, class='raw-btn') Edit
                        a(href=`/reviews/${review.id}/delete`, class='raw-btn') Delete
        script(src="/javascripts/reviewLikes.js")
        script(src='/javascripts/login.js')
    else
        div
            img(src=`${games.url}`, alt="video game image")
        div(class='game-title')= games.title
        div(class='game-studio')= games.studio
        div(class='game-avgRating')= games.avgCleanRating
        div(class='game-description')= games.description
        div
            //- form(action=`/games/${games.id}/rating`, method="post")
            //-     //- input(type="hidden", name="_csrf" value=importedToken)
            //-     label(for="soap") How Clean?
            //-     div
            //-         select(name="soap")
            //-             option(value=1) ðŸ§¼
            //-             option(value=2) ðŸ§¼ðŸ§¼
            //-             option(value=3) ðŸ§¼ðŸ§¼ðŸ§¼
            //-             option(value=4) ðŸ§¼ðŸ§¼ðŸ§¼ðŸ§¼
            //-             option(value=5) ðŸ§¼ðŸ§¼ðŸ§¼ðŸ§¼ðŸ§¼
            //-         button(type="submit") Clean!

        //- div
        //-     if slapOn
        //-         p This game is already on this shelf
        //-     form(action=`/users/${userId}/addGame/${gameId}`, method="post")
        //-         //- input(type="hidden", name="_csrf" value=importedToken)
        //-         select(name="shelfId")
        //-             each shelf in shelves
        //-                 option(value=shelf.id)= shelf.name
        //-         button(type='submit') Add/Delete Game to Shelf
        div(class='game-date')= games.releaseDate
        //- if user
        //-     div #{user.firstName}
        //- div.anything
        //-     +validationErrorSummary(errors)
        //-     form(action=`/games/${games.id}`, method="post")
        //-         input(type="hidden" name="_csrf" value=token)
        //-         textarea(name="content")
        //-         button(type="submit") Add A Review
        ul
            each review in games.Reviews
                li(class='username') #{review.User.username}
                li(class='content') #{review.content}
                li(id=`list${review.id}`, class='likes') Likes: #{review.ReviewLikes.length}
                //- div(id=review.id class='reviewId')

                //- div(id=userId class='myGamesUserId')
                //- input(type="hidden" id='myGamesUserId' value=userId)
                //- div(id=shelfName class='myGamesGameId')
                //- if user
                //-     div(id=userId class='userId')
                //-     div(id=gameId class='gameId')
                //-     //- form(action=`/reviews/${review.id}`, method="post")
                //-     button( class=`likes` id=review.id) Like!
                //-     if user.id === review.userId
                //-         a(href=`/reviews/${review.id}/edit`) Edit
                //-         a(href=`/reviews/${review.id}/delete`) Delete
        //- script(src="/javascripts/reviewLikes.js")
        script(src='/javascripts/login.js')
